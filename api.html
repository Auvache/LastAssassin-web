<!DOCTYPE html>
<html>

<head>
  <title>Last API v2</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <h2>Create Game</h2>

  <button onclick="Create()">Send</button>
  <p id="create_result">Results will go here.</p>

  <h2>Start Game</h2>

  <label for="scode">Game Code:</label>
  <input type="text" id="scode" name="scode" /><br /><br />
  <button onclick="Start()">Send</button>
  <p id="start_result">Results will go here.</p>

  <h2>Lobby Heartbeat</h2>

  <label for="lcode">Game Code:</label>
  <input type="text" id="lcode" name="lcode" /><br /><br />
  <label for="lname">Player Name:</label>
  <input type="text" id="lname" name="lname" /><br /><br />
  <button onclick="Lobby()">Send</button>
  <p id="lobby_result">Results will go here.</p>

  <h2>In-Game Heartbeat</h2>

  <label for="code">Game Code:</label>
  <input type="text" id="code" name="code" /><br /><br />
  <label for="name">Player Name:</label>
  <input type="text" id="name" name="name" /><br /><br />
  <label for="lat">Latitude:</label>
  <input type="number" id="lat" name="lat" value=".0005" /><br /><br />
  <label for="long">Longitude:</label>
  <input type="number" id="long" name="long" value=".0005" /><br /><br />
  <label for="timestamp">Timestamp:</label>
  <input type="datetime-local" id="timestamp" name="timestamp" /><br /><br />
  <button onclick="Game()">Send</button>
  <p id="game_result">Results will go here.</p>

  <script src="https://cdn.socket.io/socket.io-3.0.1.min.js"></script>
  <script>
    const api_url = "http://lastapi.stevenrummler.com/";

    function Create() {
      fetch(api_url, {
          method: "GET",
          headers: {
            Accept: "application/json",
          },
        })
        .then((response) => {
          console.log("Response: ", response);
          return response.json();
        })
        .then((data) => {
          document.getElementById("create_result").innerHTML = JSON.stringify(data);
          // Set other game code inputs to this code.
          console.log(data);
          document.getElementById("scode").value = data.Game;
          document.getElementById("lcode").value = data.Game;
          document.getElementById("code").value = data.Game;
        })
        .catch((error) => {
          console.error("Error:", error);
        });
    }

    function Start() {
      const code = document.getElementById("scode").value;
      const delay = document.getElementById("delay").value;
      const request = {
        Game: code,
        Delay: delay,
      };
      fetch(api_url, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Accept: "application/json",
          },
          body: JSON.stringify(request),
        })
        .then((response) => {
          console.log("Response: ", response);
          return response.json();
        })
        .then((data) => {
          document.getElementById("start_result").innerHTML = JSON.stringify(data);
        })
        .catch((error) => {
          console.error("Error:", error);
        });
    }

    function Lobby() {
      const code = document.getElementById("lcode").value;
      const name = document.getElementById("lname").value;
      document.getElementById("name").value = name;
      const request = {
        Game: code,
        Player: name,
      };
      fetch(api_url, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Accept: "application/json",
          },
          body: JSON.stringify(request),
        })
        .then((response) => {
          console.log("Response: ", response);
          return response.json();
        })
        .then((data) => {
          document.getElementById("lobby_result").innerHTML = JSON.stringify(data);
        })
        .catch((error) => {
          console.error("Error:", error);
        });
    }

    function Game() {
      const code = document.getElementById("code").value;
      const name = document.getElementById("name").value;
      const lat = document.getElementById("lat").value;
      const long = document.getElementById("long").value;
      const request = {
        Game: code,
        Player: name,
        Latitude: lat,
        Longitude: long,
      };
      fetch(api_url, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Accept: "application/json",
          },
          body: JSON.stringify(request),
        })
        .then((response) => {
          console.log("Response: ", response);
          return response.json();
        })
        .then((data) => {
          document.getElementById("game_result").innerHTML = JSON.stringify(data);
        })
        .catch((error) => {
          console.error("Error:", error);
        });
    }
  </script>
</body>

</html>